
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title></title>
</head>

<body background="../images/thunder.gif" text="#FFFFFF" bgcolor="#000000">
<p align="center"><font size="5" color="#FFFFFF"><u><b>TELEFONNÍ KARTY</b></u></font>
<p><font face="IMPACT CE,IMPACT" size="+2">Urèitì</font> je znáte všichni.
Setkáváte se s nimi dnes a dennì a to a u v podobì klasickıch telefonních
nebo GSM-SIM aktivaèních karet. A právì o tìch prvních bude dnes øeè.</p>
<p>Kolik z vás u asi napadlo, jestli by tu malou plastovou kartièku o rozmìrech
85.6x54x0.76mm nešlo nìjak &quot;oblbnout&quot; a volat tak zadarmo.
Teoreticky by to nemìl bıt problém, prakticky to problém je. Proè to se
dozvíte dále.
<p>Pøedtím, ne se podíváme na telefonní karty blíe, podívejme se
trochu na historii a pouití èipovıch karet. V polovinì 80. let se objevila
nová generace èipovıch a &quot;smart-card&quot; karet (èipy do tìch úplnì
prvních vynalezl v roce 1974 Roland Moreno). Zatímco ty první byly a jsou
hloupé (a budou?), ty druhé mívají u sebe mikroprocesor nebo podobnou hraèku,
èili poskytují vyšší úrovìò zabezpeèení. Tyto karty nahradili nìkteré
magnetické kreditní karty a zaèali se pouívat ve veøejnıch telefonních
automatech k platbì místo mincí. S kartami, které mají mikroprocesor jste
se mohli setkat u bankomatù, šifrovacích karet pro kabelové TV-dekodéry (tøeba
nìmecká Premiere), dále pak v podobì zdravotních karet (hlavnì Anglie) a
dnes nejèastìji v mobilních telefonech GSM. Rozsah pouití tìchto karet je
velmi širokı. I ty nejhloupìjší karty bez mikroprocesoru se dají pouít
tøeba jako hardwarovı klíè ke dveøím, auto-alarmu, ochranì dat v poèítaèi
(sestrojíte èteèku, napíšete program a pokud karta nemá správné sériové
èíslo &quot;Hastala Vista Baby&quot;)
<p>Èipové karty se øídí normou ISO 7816. To se tıká pøedevším fyzikálních
vlastností a odolnosti proti mechnickım a elektromagnetickım vlivùm
(7816-1). Velikosti karty a umístìní èipu je popsáno v èásti 7816-2. Koneènì
se dostáváme k èásti 7816-3, která popisuje komunikaèní protokoly. Ty se
mohou podle druhu pouití od normy velmi lišit (záleí také na vırobci).
Ale zpìt k hlavnímu tématu dnešního èlánku: Jakı je zádrhel v doplnìní
novıch jednotek na kartu? Nebo udìlat z 50jednotkové karty 150jednotkovou!!!
Zádrhelù je nìkolik. Pro doplnìní novıch jednotek by bylo potøeba èip (èipy
v tel. kartách jsou 256bitové sériové EPROM, vyrábìné technologií NMOS)
vymazat UV záøením. Proti tomuto zpùsobu vymazání je však èip chránìn
pryskyøicí, která nepropouští UV záøení. Pokud by vám toto povedlo poøád
nemáte vyhráno. Jak je patrné z pøiloené tabulky, smazalo by se i prvních
96bitù, kde jsou uloeny vırobní údaje. Tato oblast je ale chránìna
pojistkou (vıvod 8 - FUSE), která je pøepálena po prvním naprogramování u
vırobce. Nové naprogramování pouité karty je tedy nemoné, co takhle
sestavit emulátor! Myšlenka pìkná, v praxi proveditelná (zvládl by to kadı
kdo umí pájet a nakupovat souèástky), ale v automatu nefunkèní. Ten si
toti otestuje i fyzikální vlastnosti karty a uznejte - podaøí se vám
napodobit originál? Tìko. I pøesto není k zahození vìdet, jak vyuít
prázdnou kartu doma.
<p>Stejnı typ karet jako u nás se pouívá ve Švédsku, Finsku, Norsku,
Portugalsku atd. Obdobné typy pouívající se napø. v Nìmecku nebo na
Slovensku mají 128bitové EEPROM vyrábìné technologií CMOS, sloitìjší
kódování jednotek a trochu jiné vıvody. V USA zase nìkteré telefonní
spoleènosti vyuívají principu centrální evidence pouívaní karet, co
témìø znemoní zneuití, prote na kartì je pouze èíslo karty a odkaz
na poèítaè, kterı pro ni vede evidenci.<center>
<table border="3">
  <tbody>
    <tr>
      <td>0..7&nbsp;</td>
      <td>kontrolní souèet</td>
    </tr>
    <tr>
      <td>8..19&nbsp;</td>
      <td>831h pro telefonní karty&nbsp;</td>
    </tr>
    <tr>
      <td>20..31</td>
      <td>poèet jednotek na nové&nbsp;<br>
        kartì v BCD kódu</td>
    </tr>
    <tr>
      <td>32..40&nbsp;</td>
      <td>kód vırobce, 00h Shlumberger,&nbsp;<br>
        40h Gemplus</td>
    </tr>
    <tr>
      <td>41..79</td>
      <td>sériové èíslo</td>
    </tr>
    <tr>
      <td>80..87</td>
      <td>11h&nbsp;</td>
    </tr>
    <tr>
      <td>88..95</td>
      <td>kód zemì, 55h Èeská republika</td>
    </tr>
    <tr>
      <td>96..255</td>
      <td>bitové pole, kadé pouité&nbsp;<br>
        jednotce odpovídá zapsanı bit</td>
    </tr>
  </tbody>
</table>
</center>Nyní se podívejme co vlastnì je na kartì. Normálnì má nejvyšší
hodnotu bit 1, zde je to však naopak - nejdùleitìjší je bit 0. Pøedstavte
si situaci: pøijdete k automatu, vloíte kartu (automat si kartu &quot;pøeète&quot;,
vytoèíte èíslo a co se dìje dál? Poté, co volanı zvedne telefon, automat
na kartu zapíše 1 (do èásti 96...255 bitù - tzv. bitové pole). Tím se na
kartì odeète jednotka, ale aby to nebylo tak jednoduché, automat si kartu
znovu &quot;pøeète&quot; a porovná s pøedchozím ètením. Pokud na kartì pøibyl
zapsanı bit, vše je v poøádku a vy voláte, pokud ne, automat pøeruší
spojení. Zde je mono pouít malı fígl. Pokud volanı pouívá záznamník,
nevíte jestli je doma a chtece ušetøit jednotku, staèí pøelepit POUZE vıvod
6 (Vpp - vstup pro zápis). Poté kartu vloit do automatu, vytoèit a poèkat
na zvednutí. A zde nastane ta pravá sranda. Pokud volanı vezme, víte, e je
doma, kartu uvedete do pùvodního stavu a zavoláte znovu. Pokud zvedne záznamník
ušetøili jste jednotku na kartì!<center>
<table border="3">
  <tbody>
    <tr>
      <td>Vıvod</td>
      <td>Vıznam</td>
      <td>Funkce</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Vcc = 5V</td>
      <td>napájení</td>
    </tr>
    <tr>
      <td>2</td>
      <td>R_/W</td>
      <td>vstup</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Clock</td>
      <td>vstup</td>
    </tr>
    <tr>
      <td>4</td>
      <td>RESET_</td>
      <td>vstup</td>
    </tr>
    <tr>
      <td>5</td>
      <td>GND = 5V</td>
      <td>napájení</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Vpp</td>
      <td>vstup</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Out</td>
      <td>vıstup</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Fuse</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>
</center><center>* vıznam _ je roven negaci!</center>
<p>A co domácí vyuití karet? pokud máte vyvolanou kartu, staèí naèíst
její obsah, ten nìkam uloit a po spuštìní programu poádat o vloení
karty. Pokud bude vloena nesprávná karta je na vás co se stane. Bitové
pole (bity 96...255) mùete libovolnì upravovat pouze za pouití zdroje
21V. Kontrolu karty lze pak provádìt nejen podle sériového èísla, ale i
podle bitového zdroje (lze tam uloit napø. heslo)
<p>To je vše, co jsem vám chtìl sdìlit. Doufám, e jste se nìèemu pøiuèili
a pro zájemce pøipojuji schéma <a href="CTECKA.HTM"><font color="#FFFF00">jednoduché
èteèky</font></a> pro PC se zdrojovım kódem programu v Pascalu.</p>
<p align="center">&nbsp;</p>
</body>

</html>
